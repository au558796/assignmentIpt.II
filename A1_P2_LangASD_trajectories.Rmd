---
title: "Assignment I pt. II"
author: "Dana Jensen"
date: "July 7, 2017"
output: html_document
---
```{r setup, include=FALSE}
#prelude
knitr::opts_chunk$set(echo = TRUE)
install.packages("ggplot2")
library(pacman)
p_load(ggplot2, dplyr, lme4, lmerTest)
locpath="C:/Users/Dana/Desktop/METHODS III/assignmentIpt.II"
setwd(locpath)
data = read.csv("df.csv")
View(df)
```
### Exercise 1) Preliminary Data Exploration, language development in Autism Spectrum Disorder (ASD)
```{r}
  ## Describe the participant samples in the dataset (e.g. by diagnosis, age,   etc.). Do you think the two groups are well balanced? If not, what do you think was the reason? Identify relevant variables: participants demographic   characteristics, diagnosis, ADOS, Verbal IQ, Non Verbal IQ, Visit, Number of   words used, Number of unique words used, length of utterance in both child    and parents. Describe the characteristics of the two groups of participants   and whether the two groups are well matched.

#important information only
data = dplyr::select(data, SUBJ, VISIT, Diagnosis, Gender, Age, Ethnicity, ADOS, MullenRaw, ExpressiveLangRaw, CHI_MLU, types_CHI, tokens_CHI, MOT_MLU)

#Let's compare the two groups
model =lm(Age~Diagnosis, data = data)#intercept = 43, slop = -12
summary(model)

plot = ggplot(model, aes(x = Diagnosis, y = Age, colour = Age)) + 
  geom_jitter(aes())+
  geom_smooth(method = "lm")
plot

model1 = glm(Gender ~ Diagnosis, family = binomial, data)
summary(model1)#cant say much except non significant

plot1 = ggplot(model1, aes(x = Diagnosis, y = Gender, color = Gender)) + 
  geom_jitter(aes())+
  geom_smooth(method = "lm")
plot1

model2=glm(Ethnicity ~ Diagnosis, family = binomial, data)
summary(model1)#not significant

plot2 = ggplot(model2, aes(x = Diagnosis, y = Ethnicity, color = Ethnicity)) +
  geom_jitter(aes())+
  geom_smooth(method = "lm")
plot2
```
[REPORT THE RESULTS]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### Exercise 2) Children learning language: the effects of time and ASD
```{r}
  ## Let's test hypothesis 1: Children with ASD display a language impairment   ## Hypothesis: The child's MLU changes: i) over time, ii) according to        diagnosis. Let's start with a simple mixed effects linear model
  ## Remember to plot the data first and then to run a statistical test.

  ##How would you evaluate whether the model is a good model?

  ## Describe linguistic development in TD and ASD children in terms of Mean    Length of Utterance (MLU)?
model3 = lmer(CHI_MLU~ VISIT + Diagnosis + (1+VISIT|SUBJ), data = data)
summary(model3)
mlu05_plot = ggplot(model3, aes(x = VISIT, y = CHI_MLU)) + 
  geom_point(aes())+
  facet_wrap(~Diagnosis)+
  geom_smooth(method = "lm")
mlu05_plot

  ## Let's check whether a growth curve model is better.
  ## Remember: a growth curve model assesses whether changes in time can be     described by linear, or quadratic, or cubic (or... etc.) components.
  ## First build the different models, then compare them to see which one is    better

```
[REPORT THE RESULTS]
Remember to report:
- the estimates for each predictor (beta estimate, standard error, p-value)
- A plain word description of the results
- Linguistic development of children MLU is affected by ... [COMPLETE]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### Exercise 3) Child directed speech as a moving target. Let's test hypothesis 2: Parents speak equally to children with ASD and TD  (Exercise 3). Hypothesis: Parental MLU changes: i) over time, ii) according to diagnosis
```{r}
  ## Describe how parental use of language changes over time in terms of MLU.   What do you think is going on?

model4 = lmer(MOT_MLU ~ VISIT + Diagnosis + (1+VISIT|SUBJ), data = data)
summary(model4)
mlu06_plot = ggplot(model4, aes(x = VISIT, y = MOT_MLU)) + 
  geom_point(aes())+
  facet_wrap(~Diagnosis)+
  geom_smooth(method = "lm")
mlu06_plot
```
[REPORT THE RESULTS]
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### Exercise 4) Looking into "individual differences" (demographic, clinical or cognitive profiles)
```{r}
  ## Create the best possible model (the one that best explain the data, with   MLU as outcome). Describe your strategy to select the best models (how did    you choose the variables to include?).

#vogue
nullModel = lm(CHI_MLU~1, data)
nullModel1=lmer(CHI_MLU~1+(1|VISIT), data)
model5 = lm(CHI_MLU ~ 1 + VISIT, data)
model6 = lm(CHI_MLU ~ 1 + VISIT + ExpressiveLangRaw, data)
model7 = lmer(CHI_MLU ~ 1 + VISIT + ExpressiveLangRaw + (1|VISIT), data, REML = F)
hashtagBestModelEver = lmer(CHI_MLU ~ 1 + VISIT + ExpressiveLangRaw + (1+VISIT | SUBJ), data, REML = F)

#anovas
a1<-anova(nullModel, model5, model6)
a2<-anova(nullModel1, model7, hashtagBestModelEver)
a1
a2

  ## Your task now is to figure out how to best describe the children           linguistic trajectory.

```
[REPORT THE RESULTS]
- Identify the statistical models that best describes your data (that is, the children's MLU). Describe how you selected the best model.
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
### [OPTIONAL] Exercise 5) Comment on how the three linguistic variables measure linguistic performance (the so-called "construct validity" of the measures). Do they express the same variance?